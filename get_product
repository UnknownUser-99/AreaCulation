from pyspark.sql import SparkSession
from pyspark.sql.functions import col

def get_product(products_df, categories_df):

    product_category_pairs = products_df.join(categories_df, "product_id", "left_outer").select("product_name", "category_name")

    products_with_no_category = products_df.join(categories_df, "product_id", "left_anti").select("product_name")

    result_df = product_category_pairs.union(products_with_no_category).withColumnRenamed("product_name", "Product").withColumnRenamed("category_name", "Category")

    return result_df
